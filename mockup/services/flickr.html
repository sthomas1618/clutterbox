#!/usr/bin/env ruby
require 'open-uri'
require 'json'

puts "Content-type: text/html"
puts
puts "<!DOCTYPE html>"
puts "<html>"
puts "<head>"
puts "  <title>ClutterBox</title>"
puts "  <meta charset=\"utf-8\">"
puts "  <link rel=\"stylesheet\" type=\"text/css\" href=\"../stylesheets/custom.css\">"
puts "</head>"
puts "<body>"
puts "  <header class=\"navHeader\">"
puts "    <div class=\"content navContent\">"
puts "      <a id=\"logo\">ClutterBox</a>"
puts "      <nav>"
puts "        <ul>"
puts "          <li><a href=\"../index.html\">Home</a></li>"
puts "          <li><a href=\"../bookmarks/popular.html\">Popular</a></li>"
puts "          <li><a href=\"chico.html\">Tags</a></li>"
puts "          <li><a href=\"../login.html\">Sign In</a></li>"
puts "        </ul>"
puts "      </nav>"
puts "    </div>"
puts "  </header>"
puts "  <div class=\"content\">"
puts "    <h1>Bookmarks tagged with <span class=\"headerTag\">Chico</span></h1>"
puts "    <section id=\"bookmarks\" class=\"feed\">"      
puts "<br>"

puts "Hello dynamic world --  #{Time.now}"

data =  JSON.parse(open("http://api.flickr.com/services/rest/?method=flickr.interestingness.getList&api_key=93495371bb07d95434cc9c821fec740c&per_page=20&format=json&nojsoncallback=1").read)

photos = data["photos"]["photo"]

photos.each do |p|
	puts p.inspect
	puts "<br>"
end

puts "    </section>"
puts "  </div>"
puts "  <footer id=\"footer\">"
puts "    &copy; Copyright Stephen Thomas 2012"
puts "  </footer>"
puts "</body>"
puts "</html>"
